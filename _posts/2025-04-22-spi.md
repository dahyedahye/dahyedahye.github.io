---
title: "[Brief Review] Beyond Single Path Integrated Gradients for Reliable Input Attribution via Randomized Path Sampling"
date: 2025-04-22 23:30:00 +0900
categories: [Brief Review]
tags: [Integrated Gradients (IG), path integration, XAI, attribution method, path-based attribution method, path sampling, stick-breaking path sampling, Dirichlet Prior]     # TAG names should always be lowercase
math: true
---

# Takeaway Summary
> **Keywords:** Integrated Gradients (IG), path integration, XAI, attribution method, path-based attribution method, path sampling, stick-breaking path sampling, Dirichlet Prior
{: .prompt-tip }

✅ **IG constructed by aggregating attributions from the multiple paths:** Averaging Integrated Gradients across many sampled trajectories drastically suppresses path‑specific noise, yielding cleaner and more object‑aligned explanations.


✅ **Randomized path sampling - Stick-breaking Path Integration:** A stick‑breaking process with tunable concentration $\alpha$ generates a diverse, yet analytically tractable, distribution of integration paths that subsumes the straight‑line IG as a special case.


✅ **Statistical visualization with SPI‑P:** By converting each pixel’s attribution distribution into the probability it exceeds a top‑5 % threshold, SPI‑P highlights features that contribute consistently and positively across all paths.


# Brief Review

## Summary

![image.png](/assets/img/posts/brief_review/2025-04-22-spi/image.png)

1. Problem Statement
    - **Integrated Gradients (IG)** integrates along a *single straight path*, which yields **path‑dependent noise** and prevents the heat‑map from being well *object‑aligned.*
    - Even variants such as **Guided IG** only *modify one path* and therefore cannot eliminate the variance that arises from using a single trajectory.
2. Main Idea
    - Generate multiple randomized integration paths, compute IG separately for each path, and aggregate their attribution scores. This statistical averaging effectively reduces noise, thereby enhancing the reliability of attribution results.
3. Path Sampling - Stick-Breaking Process (SBP)
    - Construction: Break a unit stick repeatedly to obtain piece lengths  $$ \pi_k $$  and locations  $$ t_k $$ , then build a probability‑mass function  $$ \displaystyle G(t)=\sum_k \pi_k ,\delta_{t_k}(t) $$ , and use its CDF,  $$ F_G(t) $$ , as the per‑feature integration path.
    - Concentration parameter  $$ \alpha(\beta_k\sim\mathrm{Beta}(1,\alpha)) $$ : Large  $$ \alpha $$   $$ \Rightarrow $$  paths converge to the IG straight line (low diversity); small  $$ \alpha $$   $$ \Rightarrow $$  diverse step‑like paths
4. SPI
    - For a model  $$ f $$ , an input  $$ \mathbf x $$ , and a baseline  $$ \bar{\mathbf x} $$ , let each feature–wise path be driven by a stick‑breaking process  $$ G_i\sim\text{SBP}(U(0,1),\alpha) $$  with CDF  $$ F_{G_i}(t) $$ . Then the SPI attribution for feature  $$ i $$  is the *expectation* of Integrated Gradients over that path distribution:
    
    $$ 
    SPI_i(\mathbf{x}; \alpha) = \mathbb{E}_\gamma[\phi_i(\gamma)] \\
    = \mathbb{E}_{G} \left[ (x_i - \bar{x}_i) \int_0^1 
    \frac{\partial f\left(\bar{\mathbf{x}} + F_G(t) \odot (\mathbf{x} - \bar{\mathbf{x}})\right)}{\partial\left(\bar{x}_i + F_G(t)(x_i - \bar{x}_i)\right)} 
    \frac{dF_G(t)}{dt} \, dt \right]
    $$ 
    
    - **inner integral**: the standard line integral that defines Integrated Gradients along a *specific* path determined by  $$ F_{\mathbf G}(t) $$ ;
    - **outer expectation**: averages those IG values over all SBP‑sampled paths, removing path‑specific noise;
    - **$$ \alpha $$  controls diversity**:  $$ \alpha\uparrow $$   $$ \Rightarrow $$  paths converge to the straight IG line,  $$ \alpha\downarrow $$   $$ \Rightarrow $$  more step‑like variations.
    - Averaging across paths greatly reduces noise and yields more object‑aligned maps
5. SPI-P (Probability)
    - If a pixel's **attribution scores significantly vary across different integration paths**, its attribution **reliability is low**—even if its average attribution is notably high or low. (In contrast, pixels that consistently show high or low attribution with low variance are reliably indicating a stable contribution, demonstrating less sensitivity to the specific integration path.)
    - Model each pixel’s distribution as  $$ \mathcal N(\mu,\sigma^2) $$  and compute the **right‑tail probability** that it exceeds the 95‑percentile threshold  $$ \Theta $$  (top 5 % of SPI‑E values):
        
        $$ 
        SPI\text{-}P_i(\mathbf{x}; \alpha) = \mathbb{P}(\Phi_i > \Theta) \\= 1 - \frac{1}{\sigma \sqrt{2\pi}} \int_{-\infty}^{\Theta} \exp\left( -\frac{(\theta - \mu)^2}{\sigma^2} \right) d\theta
        $$ 
        
    - Pixels with high  $$ \text{SPI‑P} $$  contribute *frequently* **and** *stably*.
6. Experiments
    - **Insertion / Deletion** (ImageNet‑val, VGG‑16, Inception‑v3, ResNet‑18): SPI achieves the best area‑under‑curve scores on every model.
    - **ROAR** (CIFAR‑10, ResNet‑18): removing the top 10 % SPI pixels and retraining causes the *largest* drop in accuracy, confirming that SPI pin‑points information the model truly relies on.

## Overview

- Task: Input attribution based on Integrated Gradients (IG)
- Goal: Obtaining clearer and more reliable input attribution
- Existing Problems
    - The exsiting single path IG methods often produce noisy and unreliable attributions during the integration of the gradients over the path defined in the input space.
- Contributions:
    - Address the inconsistency in attribution caused by the choice of integration paths.
    - Propose a random sampling method for generating integration paths inspired by the Stick-Breaking Process.
    - Propose an improved visualization method for attribution by leveraging statistical analyses of attribution scores, enabling clearer interpretation.
    - Validate the reliability of the proposed method across various network architectures.
- Limitations & Possible future works:
    - Choosing Alternative Base Distributions:
        - The paper uses a stick-breaking process (SBP) anchored on a *uniform* base distribution  $$ H=U(0,1) $$ , ensuring the *average* path matches the linear path used in IG.
        - The authors note that replacing  $$ H $$  with a **Gaussian** base (adjusting its mean/variance) would create paths that move faster in the early or the late part of the integration.
    - Expanding Path-Sampling Methods:
        - The current paper employs SBP with uniformly distributed paths; exploring alternative path-generation methods remains an interesting avenue for future research.
    - Randomising or Diversifying the Baseline:
        - Introducing randomness to the baseline presents another promising direction for diversifying the integration paths sampled during attribution.


## Source

- BibTeX:
    
    ```latex
    @inproceedings{jeon2023beyond,
      title={Beyond Single Path Integrated Gradients for Reliable Input Attribution via Randomized Path Sampling},
      author={Jeon, Giyoung and Jeong, Haedong and Choi, Jaesik},
      booktitle={Proceedings of the IEEE/CVF International Conference on Computer Vision},
      pages={2052--2061},
      year={2023}
    }
    ```
    
- URL: [https://openaccess.thecvf.com/content/ICCV2023/papers/Jeon_Beyond_Single_Path_Integrated_Gradients_for_Reliable_Input_Attribution_via_ICCV_2023_paper.pdf](https://openaccess.thecvf.com/content/ICCV2023/papers/Jeon_Beyond_Single_Path_Integrated_Gradients_for_Reliable_Input_Attribution_via_ICCV_2023_paper.pdf)